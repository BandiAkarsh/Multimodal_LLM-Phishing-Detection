# Phishing Detection Project - Complete Documentation

## Project Overview

This documentation provides a comprehensive guide to the **Multimodal LLM-based Phishing Detection System**. The project is designed to detect phishing websites using a combination of:

1. **Machine Learning** - Random Forest classifier trained on 46,000+ URLs
2. **Web Scraping** - Real-time analysis of website content
3. **Typosquatting Detection** - Identifies brand impersonation attempts using 1,592 valid TLDs
4. **Toolkit Fingerprinting** - Detects Gophish, Evilginx2, SocialFish, and other phishing frameworks
5. **AI Content Detection** - Identifies AI-generated phishing content
6. **Large Language Models** - Provides human-readable explanations

## Key Feature: 4-Category Classification

The system classifies URLs into four distinct categories:

| Category | Color | Description |
|----------|-------|-------------|
| **LEGITIMATE** | Green | Safe, verified websites |
| **PHISHING** | Red | Malicious sites attempting credential theft |
| **AI_GENERATED** | Orange | Phishing content likely generated by LLMs |
| **PHISHING_KIT** | Dark Red| Sites using known toolkits like Gophish or Evilginx2 |

## Thunderbird Integration

The project includes **Thunderbird Phishing Guard**, a MailExtension that:
- Monitors incoming emails in real-time
- Extracts and analyzes URLs from email bodies
- Injects warning banners directly into suspicious emails
- Provides a detailed security popup for email users

## Documentation Structure

| Document | Description |
|----------|-------------|
| `00_Project_Overview.md` | This file - project introduction |
| `01_Data_Folder.md` | Datasets, data structure, TLD database |
| `02_Models_Folder.md` | Trained models, how to use them |
| `03_Training_Folder.md` | Training scripts with explanations |
| `04_Inference_Folder.md` | API, service, and schemas |
| `05_Utils_Folder.md` | Utility modules (scraping, AI, TLDs) |
| `06_Entry_Points.md` | Main scripts (detect.py, scan_email.py) |
| `07_Docker_Deployment.md` | Docker setup and deployment guide |
| `08_GUI_Guide.md` | Desktop GUI application guide |
| `10_gophish_testing.md`| Specialized guide for toolkit testing |
| `11_Thunderbird_Extension.md` | Thunderbird add-on guide |
| `12_User_Manual.md` | Non-technical guide for the Unified Suite |
| `13_Implementation_Guide.md` | Technical breakdown of the Suite architecture |

## System Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                            USER INTERFACES                                  │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌────────────────┐  ┌─────────┐  │
│  │ detect.py│  │  gui.py  │  │  api.py  │  │ imap_scanner.py│  │ T-Bird  │  │
│  │   (CLI)  │  │  (GUI)   │  │  (REST)  │  │ (Email Monitor)│  │ Add-on  │  │
│  └────┬─────┘  └────┬─────┘  └────┬─────┘  └────────┬───────┘  └────┬────┘  │
└───────┼─────────────┼─────────────┼─────────────────┼───────────────┼───────┘
        │             │             │                 │               │
        └─────────────┴──────┬──────┴─────────────────┴───────────────┘
                             │
┌────────────────────────────┴────────────────────────────────────────────────┐
│                          DETECTION SERVICE                                  │
│  ┌──────────────────────────────────────────────────────────────────────┐   │
│  │                   PhishingDetectionService                           │   │
│  │  ┌─────────────────┐  ┌────────────────────────────────────────────┐ │   │
│  │  │ Connectivity    │  │ analyze_url_async()                        │ │   │
│  │  │ Monitor         │  │ ┌──────────────────┐  ┌──────────────────┐ │ │   │
│  │  └────────┬────────┘  │ │ 4-Way Classifier │  │ Content Override │ │ │   │
│  │           │           │ └──────────────────┘  └──────────────────┘ │ │   │
│  │           │           │  ┌──────────┐ ┌──────────┐ ┌─────────────┐ │ │   │
│  │           │           │  │ Online   │ │ Toolkit  │ │ AI Detect   │ │ │   │
│  │           │           │  │ Analysis │ │ Analysis │ │ Analysis    │ │ │   │
│  │           │           │  └──────────┘ └──────────┘ └─────────────┘ │ │   │
│  │           │           └────────────────────────────────────────────┘ │   │
│  └───────────┼──────────────────────────────────────────────────────────┘   │
└──────────────┼──────────────────────────────────────────────────────────────┘
               │
┌──────────────┴──────────────────────────────────────────────────────────────┐
│                        UTILITY MODULES (05_utils/)                          │
│  ┌────────────────┐ ┌────────────────┐ ┌──────────────────────────┐         │
│  │ URLFeature     │ │ WebScraper     │ │ TyposquattingDetector    │         │
│  │ Extractor      │ │ (Playwright)   │ │ (1592 TLDs Database)     │         │
│  └────────────────┘ └────────────────┘ └──────────────────────────┘         │
│  ┌────────────────┐ ┌────────────────┐ ┌──────────────────────────┐         │
│  │ Connectivity   │ │ MLLM           │ │ URL Extractor            │         │
│  │ Checker        │ │ Transformer    │ │ (Shared Utility)         │         │
│  └────────────────┘ └────────────────┘ └──────────────────────────┘         │
└─────────────────────────────────────────────────────────────────────────────┘
```

## Detection Logic Flow

```
URL Input
    │
    ▼
┌─────────────────────────────────────────┐
│ CHECK INTERNET CONNECTION               │
│   - Ping DNS servers (1.1.1.1, 8.8.8.8) │
│   - Load 1592 TLDs from database        │
└─────────────────────────────────────────┘
    │
    ├── ONLINE ──────────────────────────────┐
    │                                        │
    ▼                                        ▼
┌─────────────────────┐          ┌─────────────────────┐
│ ONLINE ANALYSIS     │          │ OFFLINE FALLBACK    │
│                     │          │                     │
│ 1. Check whitelist  │          │ 1. Extract URL      │
│ 2. Typosquatting    │          │    features         │
│ 3. Toolkit Detection│          │ 2. Vowel/consonant  │
│ 4. Web scraping     │          │    analysis         │
│ 5. AI Phish Detect  │          │ 3. ML prediction    │
│ 6. Content Override │          │ 4. Static risk      │
│                     │          │    score            │
│ IGNORES static      │          │                     │
│ URL heuristics!     │          │ Add "[OFFLINE]"     │
│                     │          │ warning             │
│                     │          │                     │
└─────────────────────┘          └─────────────────────┘
    │                                        │
    └────────────────────┬───────────────────┘
                         │
                         ▼
              ┌─────────────────────┐
              │ FINAL CLASSIFICATION│
              │                     │
              │ - LEGITIMATE        │
              │ - PHISHING          │
              │ - AI_GENERATED      │
              │ - PHISHING_KIT      │
              │                     │
              │ - Confidence %      │
              │ - Risk Score 0-100  │
              │ - Explanation       │
              └─────────────────────┘
```

## Key Files Changed for Internet-Aware Detection

| File | Change |
|------|--------|
| `05_utils/connectivity.py` | **NEW** - Internet connectivity checker |
| `04_inference/service.py` | Dual-mode analysis (online/offline) |
| `detect.py` | Connectivity status display, --offline flag |
| `scan_email.py` | Async support, connectivity fallback |
| `imap_scanner.py` | Periodic connectivity check |
| `04_inference/api.py` | Connectivity endpoint, status in responses |
| `gui.py` | **NEW** - Beautiful desktop application |
| `Dockerfile` | Playwright dependencies |
| `docker-compose.yml` | Connectivity settings |

## Contact & Support

For issues or questions, please open an issue on GitHub.

---

*Documentation generated for Phishing Detection Project v2.0*
