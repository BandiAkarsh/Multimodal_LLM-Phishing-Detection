# 01_data Folder Documentation

## Overview

The `01_data/` folder contains all datasets used for training and evaluating the phishing detection system. It follows a standard machine learning data organization pattern.

## Folder Structure

```
01_data/
├── raw/                    # Original, unprocessed datasets
│   ├── combined_dataset.csv    # Main phishing URL dataset (46,000+ URLs)
│   ├── phishtank.csv           # PhishTank verified phishing URLs
│   └── openphish.txt           # OpenPhish phishing feed
│
├── processed/              # Preprocessed and scraped data
│   ├── screenshots/        # Website screenshots (PNG images)
│   ├── html/               # Raw HTML content from scraping
│   ├── metadata/           # JSON files with URL features
│   ├── mllm_features/      # MLLM-generated text descriptions
│   └── processing_results.csv  # Scraping success/failure log
│
└── splits/                 # Train/validation/test splits
    ├── train.csv           # Training data (~80%)
    ├── val.csv             # Validation data (~10%)
    └── test.csv            # Test data (~10%)
```

---

## Detailed Folder Explanations

### 1. `raw/` - Raw Datasets

This folder contains the original datasets **as downloaded** from phishing databases. No modifications have been made to these files.

#### `combined_dataset.csv`
- **Purpose**: Main training dataset
- **Size**: ~3.2 MB, 46,000+ URLs
- **Format**: CSV with columns `url`, `label`
- **Labels**: 
  - `1` = Phishing (malicious)
  - `0` = Legitimate (safe)
- **Source**: Combination of PhishTank and OpenPhish

**Example content:**
```csv
url,label
https://paypa1-secure-login.com/verify,1
https://googIe.com.malicious.net,1
https://amaz0n-deals.xyz,1
```

#### `phishtank.csv`
- **Purpose**: Raw PhishTank database export
- **Size**: ~9.3 MB
- **Source**: [PhishTank](https://phishtank.org) - Community-verified phishing database
- **Why it's used**: PhishTank provides human-verified phishing URLs, making it highly reliable

#### `openphish.txt`
- **Purpose**: OpenPhish phishing feed (plain text list)
- **Size**: ~18 KB, 300+ URLs
- **Source**: [OpenPhish](https://openphish.com) - Automated phishing feed
- **Format**: One URL per line

---

### 2. `processed/` - Preprocessed Data

This folder contains data that has been **scraped and processed** from the raw URLs. This is the multimodal data used for advanced detection.

#### `screenshots/`
- **Purpose**: Visual snapshots of websites
- **Format**: PNG images (1920x1080 resolution)
- **Naming**: `{index}.png` (e.g., `0.png`, `1.png`)
- **Why it's used**: Visual analysis can detect phishing pages that mimic legitimate sites
- **Note**: Currently stored for future visual model integration

#### `html/`
- **Purpose**: Raw HTML content of scraped websites
- **Format**: `.html` files
- **Naming**: `{index}.html`
- **Why it's used**: HTML analysis reveals forms, input fields, and suspicious scripts

#### `metadata/`
- **Purpose**: Extracted features from each URL + DOM structure
- **Format**: JSON files
- **Naming**: `{index}.json`

**Example file (`0.json`):**
```json
{
  "idx": 0,
  "url": "https://qrco.de/JABgNaFsAAw2fwSvM3S3gx7oQIqeLRBK",
  "label": 1,
  "screenshot_path": "01_data/processed/screenshots/0.png",
  "html_path": "01_data/processed/html/0.html",
  "dom_structure": {
    "num_forms": 0,
    "num_inputs": 0,
    "num_links": 0,
    "num_images": 0,
    "num_scripts": 1,
    "num_iframes": 0,
    "has_login_form": false,
    "title": "",
    "meta_tags": 7
  },
  "url_features": {
    "url_length": 48,
    "domain_length": 4,
    "path_length": 33,
    "num_dots": 1,
    "is_https": 1,
    "entropy": 4.97
  }
}
```

**What each field means:**

| Field | Description | Why It Matters |
|-------|-------------|----------------|
| `idx` | Unique identifier | Links to other files |
| `url` | Original URL | The URL being analyzed |
| `label` | Ground truth | 1 = phishing, 0 = legitimate |
| `screenshot_path` | Path to screenshot | For visual analysis |
| `html_path` | Path to HTML file | For content analysis |
| `dom_structure` | Parsed DOM features | See below |
| `url_features` | URL-based features | See below |

**DOM Structure Features:**
- `num_forms`: Number of `<form>` tags (login pages have many)
- `num_inputs`: Number of `<input>` fields (credential forms)
- `num_links`: Number of `<a>` tags (real sites have many)
- `num_images`: Number of `<img>` tags
- `num_scripts`: Number of `<script>` tags
- `num_iframes`: Number of `<iframe>` tags (often used for embedding)
- `has_login_form`: True if password input found
- `title`: Page title (empty = suspicious)
- `meta_tags`: Number of meta tags

#### `mllm_features/`
- **Purpose**: Text descriptions generated by the Qwen2.5 LLM
- **Format**: JSON files
- **Naming**: `{index}_mllm.json`

**Example file (`0_mllm.json`):**
```json
{
  "idx": 0,
  "url": "https://qrco.de/JABgNaFsAAw2fwSvM3S3gx7oQIqeLRBK",
  "label": 1,
  "text_description": "Based on the provided analysis, the website exhibits several characteristics that could be indicative of a phishing attempt. The short domain name 'qrco.de' combined with a long random path suggests URL shortening abuse. The empty page title and minimal content are red flags...",
  "original_metadata_path": "01_data/processed/metadata/0.json"
}
```

**Why MLLM features?**
- Provides human-readable explanations
- Captures semantic patterns
- Can be used as input for text-based classifiers

#### `processing_results.csv`
- **Purpose**: Log of scraping success/failure
- **Columns**: `url`, `success`, `error_message`, `timestamp`
- **Why it's used**: Track which URLs could not be scraped

---

### 3. `splits/` - Train/Val/Test Splits

These files contain the data splits for model training and evaluation.

#### `train.csv`
- **Purpose**: Training data
- **Size**: ~2.6 MB
- **Split**: ~80% of total data
- **Usage**: Used by `03_training/train_ml.py`

#### `val.csv`
- **Purpose**: Validation data
- **Size**: ~10% of total data
- **Usage**: Hyperparameter tuning

#### `test.csv`
- **Purpose**: Test data (held out)
- **Size**: ~10% of total data
- **Usage**: Final evaluation only

---

## How the Data is Used

### Training Pipeline

```
raw/combined_dataset.csv
        │
        ▼
┌─────────────────────┐
│ 03_training/        │
│ train_ml.py         │
│                     │
│ 1. Load CSV         │
│ 2. Extract features │
│ 3. Train model      │
│ 4. Save to 02_models│
└─────────────────────┘
```

### Scraping Pipeline

```
raw/combined_dataset.csv
        │
        ▼
┌─────────────────────┐
│ 05_utils/           │
│ web_scraper.py      │
│                     │
│ 1. Scrape each URL  │
│ 2. Save screenshot  │
│ 3. Save HTML        │
│ 4. Extract DOM      │
│ 5. Save metadata    │
└─────────────────────┘
        │
        ▼
processed/metadata/*.json
```

### MLLM Pipeline

```
processed/metadata/*.json
        │
        ▼
┌─────────────────────┐
│ 05_utils/           │
│ mllm_transformer.py │
│                     │
│ 1. Load metadata    │
│ 2. Generate prompt  │
│ 3. Run Qwen2.5 LLM  │
│ 4. Save description │
└─────────────────────┘
        │
        ▼
processed/mllm_features/*_mllm.json
```

---

## Data Quality Notes

1. **Phishing URLs expire quickly** - Many URLs in the dataset may no longer be active
2. **Legitimate URLs are replicated** - The training script replicates safe URLs to balance the dataset
3. **Labels are from PhishTank** - Human-verified, but not 100% accurate
4. **Scraping may fail** - Some sites block bots or are offline

---

## How to Add New Data

### Adding Phishing URLs

1. Add URLs to `raw/openphish.txt` (one per line)
2. Or add to `raw/combined_dataset.csv` with `label=1`
3. Retrain: `python 03_training/train_ml.py`

### Adding Legitimate URLs

1. Add to `raw/combined_dataset.csv` with `label=0`
2. Retrain: `python 03_training/train_ml.py`

---

## File Size Summary

| File | Size |
|------|------|
| `combined_dataset.csv` | ~3.2 MB |
| `phishtank.csv` | ~9.3 MB |
| `openphish.txt` | ~18 KB |
| `train.csv` | ~2.6 MB |
| `metadata/*.json` | ~1 KB each |
| `mllm_features/*.json` | ~2.5 KB each |

---

*This documentation explains the `01_data/` folder for beginners.*
